// Generated by Utopia Compiler - CUDA Backend
// GPU acceleration with NVIDIA CUDA

#include <cuda_runtime.h>
#include <cuda.h>
#include <device_launch_parameters.h>
#include <stdio.h>
#include <stdlib.h>

#define CUDA_CHECK(call) \
    do { \
        cudaError_t err = call; \
        if (err != cudaSuccess) { \
            fprintf(stderr, "CUDA error at %s:%d - %s\n", __FILE__, __LINE__, cudaGetErrorString(err)); \
            exit(1); \
        } \
    } while(0)

int main() {
    int device_count = 0;
    CUDA_CHECK(cudaGetDeviceCount(&device_count));
    printf("Found %d CUDA devices\n", device_count);
    
    if (device_count > 0) {
        CUDA_CHECK(cudaSetDevice(0));
        printf("Hello from Utopia CUDA!\n");
        // Your kernel calls here
    }
    
    return 0;
}
